---
phase: 11-mock-data-generation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - prisma/seed.ts
autonomous: true

must_haves:
  truths:
    - "Running seed creates 15 provider users with names, avatars, bios, and experience"
    - "Providers have mixed Arabic/English names for locale diversity"
    - "Each provider has 1-3 gigs with category-appropriate titles and descriptions"
    - "All 13 service categories have at least one gig"
    - "Gigs have realistic 3-tier pricing (Basic/Standard/Premium) based on category"
    - "Gigs have Lorem Picsum portfolio images"
  artifacts:
    - path: "prisma/seed.ts"
      provides: "Provider generation and gig creation with helper functions"
      contains: "generateCategoryTitle"
  key_links:
    - from: "seedUsers()"
      to: "prisma.user.upsert"
      via: "upsert with @herafi-seed.test emails"
      pattern: "prisma\\.user\\.upsert"
    - from: "seedGigs()"
      to: "prisma.gig.upsert"
      via: "upsert with slug-based lookup"
      pattern: "prisma\\.gig\\.upsert"
    - from: "seedGigs()"
      to: "generateCategoryTitle|generateCategoryDescription|generateCategoryPricing"
      via: "helper function calls"
      pattern: "generateCategory(Title|Description|Pricing)"
---

<objective>
Populate seedUsers() and seedGigs() functions in the existing seed script with 15 provider profiles and category-distributed gigs with realistic content.

Purpose: Creates the foundation data (providers and gigs) that orders and reviews depend on.
Output: Updated prisma/seed.ts with working seedUsers() and seedGigs() plus helper functions for category-specific content generation.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/11-mock-data-generation/11-RESEARCH.md
@.planning/phases/10-mock-data-infrastructure/10-01-SUMMARY.md
@prisma/seed.ts
@prisma/schema.prisma
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add helper functions and populate seedUsers()</name>
  <files>prisma/seed.ts</files>
  <action>
Add the following to prisma/seed.ts, keeping the existing imports, PrismaClient setup, cleanup(), and main() structure intact:

1. **Add locale imports** at the top (alongside existing faker import):
   ```
   import { fakerAR, fakerEN } from '@faker-js/faker';
   ```
   Keep the existing `import { faker } from '@faker-js/faker'` and `faker.seed(SEED_VALUE)` -- the base faker instance is still needed for non-locale-specific generation.

2. **Add Category type** from Prisma for type safety:
   ```
   import { Category } from '@prisma/client';
   ```

3. **Add the CATEGORIES constant** array with all 13 values matching the Prisma enum exactly:
   `PLUMBING, PAINTING, CLEANING, CARPENTRY, WELDING, ELECTRICAL, HVAC, LANDSCAPING, MOVING, CAR_WASHING, DIGITAL_DESIGN, DIGITAL_WRITING, OTHER`

4. **Add helper functions** (before seedUsers):
   - `generateCategoryTitle(category: Category): string` -- Uses lookup table with 3 titles per category (copy from RESEARCH.md Pattern 3). Returns `faker.helpers.arrayElement(templates[category])`.
   - `generateCategoryDescription(category: Category): string` -- Combines `faker.lorem.paragraph()` intro + skills + `faker.lorem.sentence()` closing.
   - `generateCategoryPricing(category: Category): object` -- Uses category-specific price ranges from RESEARCH.md Pattern 3. Returns { basic: {name, price, description, deliveryDays}, standard: {...}, premium: {...} }.

5. **Populate seedUsers()** to create 15 providers:
   - Loop i = 0 to 14
   - Alternate locale: `i % 2 === 0` uses fakerAR, odd uses fakerEN
   - Email: `provider${i + 1}@herafi-seed.test`
   - Use `prisma.user.upsert()` with `where: { email }`, empty `update: {}`, and create with:
     - name: localeFaker.person.fullName()
     - username: fakerEN.internet.username().toLowerCase() (always English for URLs)
     - avatarUrl: `https://api.dicebear.com/9.x/avataaars/svg?seed=${email}`
     - isProvider: true
     - providerBio: localeFaker.lorem.paragraph()
     - professionalSummary: localeFaker.lorem.paragraphs(2)
     - skills: [] (updated after gigs created)
     - yearsOfExperience: faker.number.int({ min: 1, max: 20 })
     - certifications: [] (empty for mock data)
     - hashedPassword: null (seed users don't need login)
   - Collect and return providers array
   - Log count

6. **Populate seedGigs()** to create 1-3 gigs per provider:
   - Fetch providers from DB: `prisma.user.findMany({ where: { email: { endsWith: '@herafi-seed.test' }, isProvider: true } })`
   - Use round-robin category index to ensure all 13 categories get coverage
   - For each provider, generate `faker.number.int({ min: 1, max: 3 })` gigs
   - Each gig uses `prisma.gig.upsert()` with slug as unique key
   - Slug format: `${faker.helpers.slugify(title).toLowerCase()}-${provider.id.slice(0, 8)}-${i}` (use first 8 chars of provider.id to keep slug reasonable length)
   - Set images to 2 Lorem Picsum URLs: `https://picsum.photos/seed/${slug}-1/800/600`
   - After creating gigs for a provider, update their skills array with gig categories:
     ```
     const providerGigs = await prisma.gig.findMany({ where: { providerId: provider.id }, select: { category: true } });
     await prisma.user.update({ where: { id: provider.id }, data: { skills: providerGigs.map(g => g.category) } });
     ```
   - Log total gig count

IMPORTANT: Do NOT use `Math.random()` anywhere -- the research warns about non-deterministic locale switching. All randomness must come from the seeded `faker` instance. The locale alternation (i % 2) is index-based and deterministic.

IMPORTANT: The `fakerAR` and `fakerEN` instances are NOT seeded by the global `faker.seed()`. You must also seed them:
```
fakerAR.seed(SEED_VALUE);
fakerEN.seed(SEED_VALUE);
```
  </action>
  <verify>
Run `npx prisma db seed` and verify:
1. No TypeScript compilation errors
2. Console shows "Seeded 15 providers"
3. Console shows gig count (should be 15-45 gigs)
4. Run a quick Prisma query to verify: `npx tsx -e "import { PrismaClient } from '@prisma/client'; import { PrismaPg } from '@prisma/adapter-pg'; import { Pool } from 'pg'; import 'dotenv/config'; const pool = new Pool({ connectionString: process.env.DATABASE_URL }); const prisma = new PrismaClient({ adapter: new PrismaPg(pool) }); prisma.user.count({ where: { isProvider: true, email: { endsWith: '@herafi-seed.test' } } }).then(c => { console.log('Providers:', c); return prisma.gig.count(); }).then(c => { console.log('Gigs:', c); return prisma.gig.groupBy({ by: ['category'], _count: true }); }).then(g => { console.log('Categories with gigs:', g.length); pool.end(); })"`
  </verify>
  <done>
15 provider users created with mixed Arabic/English names, DiceBear avatars, bios, and experience. 15-45 gigs created across all 13 categories with category-appropriate titles, descriptions, 3-tier pricing, and Lorem Picsum images. Provider skills updated to reflect their gig categories.
  </done>
</task>

</tasks>

<verification>
1. `npx prisma db seed` completes without errors
2. Database has exactly 15 provider users with @herafi-seed.test emails
3. All 13 categories have at least 1 gig
4. Each gig has pricingTiers with basic/standard/premium structure
5. Running seed twice produces same results (idempotent)
</verification>

<success_criteria>
- 15 providers with complete profiles (name, avatar, bio, experience, skills)
- All 13 service categories represented in gigs
- Category-appropriate pricing tiers
- Deterministic output (same data on re-run)
</success_criteria>

<output>
After completion, create `.planning/phases/11-mock-data-generation/11-01-SUMMARY.md`
</output>
